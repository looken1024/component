## 动手做AI Agent

### 生成式人工智能应用需要经历的5个层级

| 层级 | AI应用 | 描述 | 示例 |
| ---- | ---- | ---- | ---- |
| L1 | Tool(工具) | 人类完成所有工作，没有任何明显的AI辅助 | Excel、PS、Matlab和AutoCAD等绝大多数应用 |
| L2 | Chatbot(聊天机器人) | 人类直接完成绝大部分工作，人类向AI询问，了解信息，AI提供信息和建议，但不直接处理工作 | 初代ChatGPT |
| L3 | Copilot(协同) | 人类和AI共同工作，工作量相当。AI根据人类要求完成工作初稿，人类进行后期矫正，修改和调整，并最终确认 | Github Copilot、Microsoft Copilot |
| L4 | Agent | AI完成绝大部分工作，人类负责设定目标、提供资源和监督结果，以及最终决策。AI进行任务拆分、工具选择、进度控制，实现目标后自主结束工作 | AutoGPT、BabyAGI、MetaGPT |
| L5 | Intelligence (智能) | 完全无须人类监督，AI自主拆解目标、寻找资源，选择并使用工具，完成全部工作，人类只须给出初始目标 | 冯·诺伊曼机器人或者……人？ |


### 生命3.0

|阶段|名称|核心特征|描述|
|--|--|--|--|
|生命1.0|前人类阶段 |生物硬件与软件均由自然选择驱动|生命体（如细菌）的“硬件”（身体结构）和“软件”（行为模式、反应）都由自然演化（基因）决定，无法在生命周期内自行设计或改变|
|生命2.0|人类阶段|生物硬件受限于自然，软件可自行设计 |生命体（人类）的“硬件”（身体）仍受限于生物学，但“软件”（知识、技能、文化）可以通过学习、教育和文化传承在生命周期内进行设计和更新|
|生命3.0|后人类阶段 |硬件与软件均可自行设计|生命体（如未来的人工智能体）不仅可以像人类一样设计自己的“软件”（能力、知识、行为模式），还能根据自己的需要改造或重新设计自己的“硬件”（物理形态、载体）|

人工智能（AI）被视为通往生命3.0的关键路径。它代表了非碳基（非生物）系统实现复杂目标的能力。

“生命3.0”是一个关于生命未来形态的哲学与技术构想，它描绘了一个智能体能够超越生物演化的限制，自主设计和升级其全部能力（包括思维和身体）的阶段，而人工智能是实现这一愿景的核心驱动力。


### 什么是Agent

在人工智能（AI）领域，Agent（智能体或智能代理） 被定义为一个能够感知环境、做出决策并采取行动的人工智能系统或计算实体。

**核心定义：**

一个人工实体，能够使用传感器感知其环境，通过决策引擎处理信息并做出决策，然后使用执行器在环境中采取行动。
它是AI系统的基本构建块，旨在展示智能行为。

**关键特性：**

- 自主性 (Autonomy)：能够在没有人类直接干预的情况下独立做出决策和行动。
- 适应性 (Adaptability)：能够学习和适应环境的变化，提高自身能力。
- 交互性 (Interactivity)：能够与人类或其他Agent进行交互，提供信息和服务。
- 功能性 (Functionality)：能够在特定领域内执行特定的任务。


### 什么是RAG
RAG，全称为 检索增强生成，是一种将信息检索与大语言模型的生成能力相结合的机器学习方法。其核心思想是：当大模型需要回答一个问题或生成内容时，它首先从外部知识库（如文档、数据库、互联网）中检索相关信息，然后将这些检索到的信息作为上下文，与大模型的内部知识结合，共同生成更准确、更可靠的答案。

#### 一、 RAG的核心流程

一个典型的RAG系统工作流程通常包含以下关键步骤，形成一个“检索-增强-生成”的闭环：

- 检索：当用户提出查询时，系统利用检索器（如向量搜索引擎）从一个或多个外部知识源中查找与查询最相关的文档或信息片段。
- 增强：将检索到的相关文档或信息作为上下文或提示的一部分，与用户的原始查询拼接在一起。
- 生成：将拼接后的、富含上下文的提示输入给大语言模型。大模型基于其内部知识和新提供的检索信息，生成最终的答案或内容。

#### 二、 RAG在Agent架构中的角色与优势**

在基于大模型的Agent系统中，RAG扮演着至关重要的角色，被视为Agent的“外挂第二大脑”或“外部记忆系统”。

**弥补大模型的固有缺陷：**

- 知识过时：大模型的训练数据有截止日期，无法获取最新信息。RAG可以实时检索最新数据（如新闻、更新的产品信息）。
- 缺乏特定领域/私有知识：大模型没有学习过企业内部文档、个人数据等私有信息。RAG可以接入这些知识库，使Agent能回答特定领域问题。
- “幻觉”问题：大模型可能生成看似合理但不准确的信息。通过提供基于检索的真实文档作为依据，RAG能显著提高生成内容的事实准确性和可靠性。

**作为Agent的记忆机制：**

- 文档将RAG视为增强Agent规划能力的两种主要记忆方法之一（另一种是基于微调的记忆）。
- RAG为Agent提供了长期、可更新的外部记忆。Agent可以将过去的交互、用户偏好、任务经验等存储起来，在需要时检索使用，从而实现更个性化的服务和持续学习。

**技术实现与形式：**

- 外部记忆可以以多种形式存储，如文本、表格或知识图谱。
- 常见的做法是使用嵌入模型将记忆数据转换为向量，通过计算向量间的语义相似度来进行检索。
- 检索到的知识通过提示词拼接或模型中间层的交叉注意力机制注入到大模型中。

#### 三、 RAG的应用场景与实例**

- 智能客服与问答系统：如基于产品知识库和GPT-4的Agent聊天助理，能生成自然且可靠的回复。
- 营销内容生成：如MarketingFM框架，利用RAG结合电商产品数据，为海量商品自动生成相关且精准的广告文案。
- 企业知识管理：通过LlamaIndex等框架，可以轻松构建基于企业私有文档（如财报、会议记录）的问答Agent。
- 研究辅助：帮助研究人员从大量文献中检索相关信息并生成综述或答案。

#### 四、 RAG面临的挑战与优化方向**

尽管强大，RAG系统也面临一些挑战，文档中提到了相应的优化方法：

- 检索质量：检索结果不相关或噪声过多会影响最终生成效果。

    - 优化方法：使用更先进的检索算法、对检索到的文档进行过滤或重排序、采用自反思机制（如Self-RAG）来评估检索内容的相关性。

- 系统效率：频繁检索外部知识库可能带来延迟。

    - 优化方法：

        - 流水线化：如RaLMSpec、PipeRAG，将检索和生成步骤并行化以降低延迟。
        - 缓存：如RAGCache，利用请求的时空局部性，缓存频繁访问的检索结果或中间状态。
        - 模型设计：如GRITLM，训练一个同时处理生成和嵌入任务的模型，减少系统组件。

- 上下文管理：将长文档和检索结果注入提示词可能使上下文过长，影响模型性能和成本。

    - 优化方法：设计更智能的上下文选择与压缩策略。

总结：RAG是一种关键的技术范式，它通过将大模型的强大生成能力与外部知识源的精确检索相结合，有效解决了大模型的知识局限性问题。在Agent系统中，RAG不仅是提升回答准确性和时效性的工具，更是构建具备长期记忆和持续学习能力的智能体的核心组件。随着检索技术、工作流优化和与大模型协同方式的不断改进，RAG将继续在构建更可靠、更强大的AI应用和Agent中发挥基石作用。


